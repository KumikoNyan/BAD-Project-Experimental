{% extends "CLEAR/base.html" %}
{% load static %}

<head>
    <link rel="stylesheet" type="text/css" href="{% static 'stylesheet4.css' %}">
    <script src="{% static 'js/styling.js' %}"></script>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/2.1.1/jquery.min.js"></script>
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.5/js/bootstrap.min.js"></script>
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.5/css/bootstrap.min.css" />
</head>


{% block content %}

<div class="row pl-3 pt-3 pr-3" style="height:700px;">
    <div class="card main-card">
        <div class="table-responsive card"
            style="overflow-y: scroll; border-radius: 15px; box-shadow: none; height: 90%; margin-bottom: 13px;">
            <table class="table table-hover table-striped" style="border-radius: 40px;">
                <thead class="sticky-top" style="background-color: #3f3e3e; color: #ffffff;">
                    <th scope="col"> Material # </th>
                    <th scope="col"> Name</th>
                    <th scope="col"> Stock</th>
                    <th scope="col"> Cost </th>
                    <th scope="col"> Total Value </th>
                    <th scope="col"></th>
                </thead>
                <tbody>
                    {% for x in materials %}
                        <tr style="height:70px;">
                            <td> {{ x.pk }} </td>
                            <td> {{ x.name }} </td>
                            <td> {{ x.stock }} </td>
                            <td> {{ x.cost }} </td>
                            <td> {{ x.total_value }} </td>
                            <td> <button type="button" class="btn btn-outline-secondary" data-toggle="modal"
                                    data-target="#editmat-modal" style="border-radius: 30px;">Edit</button>
                            </td>
                        </tr>


                        <!-- modal to edit materials -->

                        <div class="modal" id="editmat-modal" tabindex="-1" role="dialog">
                            <div class="modal-content">
                                <div class="modal-body">
                                    <div class="container-fluid">
                                        <div class="row">
                                            <div class="col-11">
                                                <h3 style="margin-bottom: 20px;">Edit Material</h3>
                                            </div>
                                            <div class="col-1"><button type="button" class="close btn-close"
                                                    data-dismiss="modal" aria-label="Close"><span
                                                        aria-hidden="true">&times;</span></button></div>
                                        </div>
                                        <form method="POST" action="{% url 'materials' %}"> {% csrf_token %}
                                            <input type="hidden" name="edit_form" value="1"></input>
                                            <input type="hidden" name="pk" value={{ x.pk }}></input>
                                            <div class="row">
                                                <div class="col">
                                                    <label for="pk">Material ID</label>
                                                    <input type="text" class="form-control" value="{{x.pk}}" readonly>
                                                </div>
                                                <div class="col">
                                                    <label for="name">Material Name</label>
                                                    <input type="text" class="form-control" id="name" name="name"
                                                        value="{{x.name}}">
                                                </div>
                                                <div class="col">
                                                    <label for="type">Material Type</label>
                                                    <select class="input-select" id="type" name="type"
                                                        placeholder={{x.type}}>
                                                        <option value="leather" {% if 'leather' in x.type %}selected{% endif %}>Textile</option>
                                                        <option value="accessory" {% if 'accessory' in x.type %}selected{% endif %}>Accessory</option>
                                                    </select>
                                                </div>
                                            </div>
                                            <div class="row pt-3">
                                                <div class="col">
                                                    <label for="stock">Stock</label>
                                                    <input type="number" class="form-control" id="stock" name="stock"
                                                        value="{{x.stock}}" readonly>
                                                </div>
                                                <div class="col">
                                                    <label for="cost">Cost</label>
                                                    <input type="number" class="form-control" id="cost" name="cost"
                                                        value="{{x.cost}}">
                                                </div>
                                                <div class="col">
                                                    <label for="unit">Unit</label>
                                                    <input type="text" class="form-control" id="unit" name="unit"
                                                        value="{{x.unit}}" readonly>
                                                </div>
                                            </div>
                                            <div class="row" style="margin: 30px 0px 10px 0px;">
                                                <div class="col" style="margin-left: -16px;">
                                                    <button type="button" class="btn dark-button" data-toggle="modal"
                                                        data-target="#delconf-modal"> Delete
                                                        Material </button>
                                                </div>
                                                <div class="col-4 order-2 text-right">
                                                    <button type="button" class="btn dark-button" data-toggle="modal"
                                                        data-target="#editconf-modal" style="margin-left: 65px;">
                                                        Save Edits </button>
                                                </div>
                                            </div>
                                    </div>
                                </div>
                            </div>



                        </div>
                        <!-- CONFIRM EDIT MATERIALS MODAL-->

                        <div class="modal" id="editconf-modal" tabindex="-1"
                            style=" margin-left: 15%; margin-top: 10%; width: 70%;">
                            <div class="modal-content">
                                <div class="modal-body">
                                    <div class="col-12">
                                        <h4 style="text-align: center;"> Confirm edits? </h4>
                                    </div>
                                    <div class="row text-center" style="margin-top: 15px;">
                                        <div class="col">
                                            <button type="button" class="btn dark-button" data-dismiss="modal"> Continue
                                                Editing </button>
                                        </div>
                                        <div class="col">
                                            <button type="submit" class="btn dark-button confirm-button" form="edit_form">
                                                Confirm </button>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- CONFIRM DELETE MATERIALS MODAL-->

                        <div class="modal" id="delconf-modal" tabindex="-1"
                            style=" margin-left: 15%; margin-top: 10%; width: 70%;">
                            <div class="modal-content">
                                <div class="modal-body">
                                    <div class="col-12">
                                        <h4 style="text-align: center;"> Delete Material? </h4>
                                    </div>
                                    <div id="confirmDeleteMaterial{{x.pk}}">
                                        <form method="POST" action="{% url 'materials' %}"> {% csrf_token %}

                                            <input type="hidden" name="delete_form" value="1">
                                            <input type="hidden" name="pk" value="{{x.pk}}">
                                            <div class="container-fluid">
                                                <div class="row text-center" style="margin-top: 15px;">
                                                    <div class="col">
                                                        <button type="button" class="btn dark-button" data-dismiss="modal">
                                                            Continue Editing
                                                        </button>
                                                    </div>
                                                    <div class="col">
                                                        <button type="submit" class="btn dark-button delete-button"
                                                            form="delete_form" value="Submit"> Confirm </button>
                                                    </div>
                                                </div>
                                            </div>
                                        </form>
                                    </div>
                                </div>
                            </div>
                        </div>
                    {% endfor %}
                </div>
        
        </tbody>
        </table>
    </div>
    <div class="row ml-auto pr-3">
        <button type="button" class="btn light-button" data-toggle="modal" data-target="#orange-modal"> Add Material
        </button>
    </div>
</div>
</tbody>
</table>

<!-- ADD MATERIAL MODAL -->

<div class="modal" id="orange-modal" tabindex="-1" role="dialog" aria-labelledby="orange-modal-label">
    <div class="modal-content">
        <div class="modal-body">
            <div class="container-fluid">
                <form method="POST" action="{% url 'materials' %}"> {% csrf_token %}
                    <input type="hidden" name="add_form" value="1"></input>
                    <div class="row">
                        <div class="col-11">
                            <h3 style="margin-bottom: 30px;">Add Material</h3>
                        </div>
                        <div class="col-1"><button type="button" class="close btn-close" data-dismiss="modal"
                                aria-label="Close"><span aria-hidden="true">&times;</span></button></div>
                    </div>
                    <div class="row">
                        <div class="col">
                            <label for="name">Material ID</label>
                            <input type="text" class="form-control" value="{{last_pk}}" readonly>
                        </div>
                        <div class="col">
                            <label for="name">Material Name</label>
                            <input type="text" class="form-control" id="name" name="name" placeholder="Material Name">
                        </div>
                        <div class="col">
                            <label for="type">Material Type</label>
                            <select class="input-select" id="type" name="type" placeholder="Material Type">
                                <option value="leather">Leather</option>
                                <option value="lining">Lining</option>
                                <option value="accessory">Accessory</option>
                            </select>
                        </div>
                    </div>
                    <div class="row pt-3">
                        <div class="col">
                            <label for="stock">Stock</label>
                            <input type="number" class="form-control" id="stock" name="stock" placeholder="Stock">
                        </div>
                        <div class="col">
                            <label for="cost">Cost</label>
                            <input type="number" class="form-control" id="cost" name="cost" placeholder="Cost">
                        </div>
                        <div class="col">
                            <label for="unit">Unit</label>
                            <input type="text" class="form-control" value="unit" readonly>
                        </div>
                    </div>
                    <div class="row pt-3" style="margin-top: 15px;">
                        <div class="col-4 mr-auto">
                            <button type="button" class="btn dark-button" data-dismiss="modal"> Cancel
                                Action</button>
                        </div>
                        <div class="col-4 ml-auto text-right">
                            <button type="button" class="btn dark-button" data-toggle="modal"
                                data-target="#confirm-modal"> Add Material
                            </button>
                        </div>
                    </div>

                </form>
            </div>
        </div>
    </div>
</div>

<!-- CONFIRM ADD MODAL -->

<div class="modal" id="confirm-modal" tabindex="-1" style=" margin-left: 5%; margin-top: 6%; width: 70%;">
    <div class="modal-content">
        <div class="modal-body">
            <div class="col-12">
                <h4 style="text-align: center;"> Add Material? </h4>
            </div>
            <div class="row text-center" style="margin-top: 15px;">
                <div class="col">
                    <button type="button" class="btn dark-button" data-dismiss="modal"> Continue
                        Editing </button>
                </div>
                <div class="col">
                    <button type="submit" class="btn dark-button confirm-button" form="add_form"> Confirm </button>
                </div>
            </div>
        </div>
    </div>
</div>



{% endblock %}